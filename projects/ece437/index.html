<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> multicore-5-stage-cpu | Akshath Raghav R </title> <meta name="author" content="Akshath Raghav Ravikiran"> <meta name="description" content="Design, Verification and Synthesis of a 5-Stage Pipelined Multicore CPU on Altera DE2-115 (&gt;50MHz)"> <meta name="keywords" content="akshath, raghav, ravikiran, araviki, portfolio, resume, cv"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/icon.png?cb6145fc58382c78e56ae25fb78b7b23"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://akshathraghav.github.io/projects/ece437/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <u>a</u>kshath raghav <u>raviki</u>ran </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/summaries/">tl;dr </a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/AkshathRaghavR_Resume.pdf">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">more </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/blog/">blog</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/gists/">gists</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/photography/">photography</a> </div> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">multicore-5-stage-cpu</h1> <p class="post-description">Design, Verification and Synthesis of a 5-Stage Pipelined Multicore CPU on Altera DE2-115 (&gt;50MHz)</p> </header> <article> <p>This project implements a dual-core pipelined processor with a snoopy-bus and split caches, provides functionally verified modules and thoroughly tests for edge cases in protocols. All source files and tcl scripts for this project can be found <a href="https://github.com/AkshathRaghav/ece437/" rel="external nofollow noopener" target="_blank">here</a>. This project was completed as a part of ECE 437, and requires that code be private – Please reach out if you’d like to view it, and are not taking the course.</p> <p>Below, I’ve formatted our Final Report (that got us an A) for the site, but want to quickly highlight that the core is tested on:</p> <ul> <li><a href="https://github.com/AkshathRaghav/ece437/blob/multicore_riscv/cpassingFiles/fib.asm" rel="external nofollow noopener" target="_blank">Fibonacci Sequence</a></li> <li><a href="https://github.com/AkshathRaghav/ece437/blob/multicore_riscv/cpassingFiles/search.asm" rel="external nofollow noopener" target="_blank">Linear Search</a></li> <li><a href="https://github.com/AkshathRaghav/ece437/blob/multicore_riscv/asm_palgorithm/mergesort.asm" rel="external nofollow noopener" target="_blank">Insertion Sort and Merge Sort</a></li> <li><a href="https://github.com/AkshathRaghav/ece437/blob/multicore_riscv/cpassingFiles/mult.asm" rel="external nofollow noopener" target="_blank">Booth’s Encoding Multiplication</a></li> <li><a href="https://github.com/AkshathRaghav/ece437/blob/multicore_riscv/cpassingFiles/count_days.asm" rel="external nofollow noopener" target="_blank">Number of Days between Dates</a></li> <li><a href="https://github.com/AkshathRaghav/ece437/blob/multicore_riscv/asm_palgorithm/palgorithm.asm" rel="external nofollow noopener" target="_blank">Producer-Consumer-based Recursive CRC ChkSum</a></li> </ul> <hr> <h1 id="overview">Overview</h1> <p>This report presents a comparison of four variants of our RISC-V processor design: the single-cycle processor, the 5- stage pipeline without caches, the pipeline with a two-level cache hierarchy, and the multicore processor. All designs execute instructions based on the same subset of the RISC Instruc- tion Set Architecture (ISA), but incrementally build on each other to replicate previous- generation CPUs, leading to differences in clock speed and hardware complexity.</p> <p>All designs execute the same <tt>mergesort</tt> benchmark (and, where necessary, the <tt>dual.mergesort</tt> variant) to ensure a fair comparison. The single-cycle processor executes a single instruction per clock cycle, leading to a straightforward design. However, since it is required to complete the multiple aspects of an instruction within a cycle, it leads to low clock speeds. On the other hand, the pipelined processor splits up part of the instruction execution into different stages, ensuring that each stage completes in a single cycle. The pipelined version without caches exposes the full memory-access latency while the cached pipeline hides much of it at the cost of added hard- ware. On the other hand, the multicore design allows for parallel speedup, but at suffers some coherence overhead. We expect the cached pipeline to outperform the uncached ver- sion as memory latency increases, and the multicore design to show greater speedup on the dual-threaded <tt>mergesort</tt>.</p> <p>To confirm our above expectations, we compare each design in the FPGA flow to collect synthesis frequency, average CPI, total execution time (for different memory access latencies), instruction latency, and resource utilization. Section 2 details the architectural diagrams and state machines for the pipeline, caches, and coherence logic; Section 3 presents the full performance and resource-utilization results; Section 4 discusses conclusions drawn from these data; and Section 5 documents individual contributions.</p> <p>Below, we provide the Instruction-type breakdowns for each benchmark used. Note that these breakdowns are generated post-simulation, and will show variance between Core 0 and Core 1 counts due to real-life multi-core coherence overhead. We will use these numbers while calculating the CPI for our designs.</p> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">Instruction Type</th> <th style="text-align: center">Count</th> <th style="text-align: center">Percentage</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">R‑Type</td> <td style="text-align: center">823</td> <td style="text-align: center">15.22%</td> </tr> <tr> <td style="text-align: center">I‑Type</td> <td style="text-align: center">834</td> <td style="text-align: center">15.42%</td> </tr> <tr> <td style="text-align: center">LW</td> <td style="text-align: center">806</td> <td style="text-align: center">14.90%</td> </tr> <tr> <td style="text-align: center">SW</td> <td style="text-align: center">691</td> <td style="text-align: center">12.77%</td> </tr> <tr> <td style="text-align: center">JAL/JALR</td> <td style="text-align: center">695</td> <td style="text-align: center">12.85%</td> </tr> <tr> <td style="text-align: center">B‑Type</td> <td style="text-align: center">1560</td> <td style="text-align: center">28.83%</td> </tr> <tr> <td style="text-align: center"><strong>TOTAL</strong></td> <td style="text-align: center">5409</td> <td style="text-align: center">100%</td> </tr> </tbody> </table> <div class="caption"> Instruction‑type breakdown for <tt>mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">Instruction Type</th> <th style="text-align: center">Core 0 Count</th> <th style="text-align: center">Core 0 Percentage</th> <th style="text-align: center">Core 1 Count</th> <th style="text-align: center">Core 1 Percentage</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">SLL</td> <td style="text-align: center">2</td> <td style="text-align: center">0.06%</td> <td style="text-align: center">2</td> <td style="text-align: center">0.09%</td> </tr> <tr> <td style="text-align: center">SRL</td> <td style="text-align: center">2</td> <td style="text-align: center">0.06%</td> <td style="text-align: center">1</td> <td style="text-align: center">0.04%</td> </tr> <tr> <td style="text-align: center">SLT</td> <td style="text-align: center">378</td> <td style="text-align: center">11.91%</td> <td style="text-align: center">300</td> <td style="text-align: center">13.30%</td> </tr> <tr> <td style="text-align: center">SLTU</td> <td style="text-align: center">32</td> <td style="text-align: center">1.01%</td> <td style="text-align: center">32</td> <td style="text-align: center">1.42%</td> </tr> <tr> <td style="text-align: center">SUB</td> <td style="text-align: center">3</td> <td style="text-align: center">0.09%</td> <td style="text-align: center">3</td> <td style="text-align: center">0.13%</td> </tr> <tr> <td style="text-align: center">ADD</td> <td style="text-align: center">34</td> <td style="text-align: center">1.07%</td> <td style="text-align: center">32</td> <td style="text-align: center">1.42%</td> </tr> <tr> <td style="text-align: center">OR</td> <td style="text-align: center">8</td> <td style="text-align: center">0.25%</td> <td style="text-align: center">0</td> <td style="text-align: center">0.00%</td> </tr> <tr> <td style="text-align: center">ORI</td> <td style="text-align: center">11</td> <td style="text-align: center">0.35%</td> <td style="text-align: center">9</td> <td style="text-align: center">0.40%</td> </tr> <tr> <td style="text-align: center">LW</td> <td style="text-align: center">476</td> <td style="text-align: center">15.00%</td> <td style="text-align: center">332</td> <td style="text-align: center">14.72%</td> </tr> <tr> <td style="text-align: center">SW</td> <td style="text-align: center">389</td> <td style="text-align: center">12.26%</td> <td style="text-align: center">303</td> <td style="text-align: center">13.43%</td> </tr> <tr> <td style="text-align: center">BEQ</td> <td style="text-align: center">863</td> <td style="text-align: center">27.19%</td> <td style="text-align: center">634</td> <td style="text-align: center">28.10%</td> </tr> <tr> <td style="text-align: center">BNE</td> <td style="text-align: center">64</td> <td style="text-align: center">2.02%</td> <td style="text-align: center">0</td> <td style="text-align: center">0.00%</td> </tr> <tr> <td style="text-align: center">ADDI</td> <td style="text-align: center">518</td> <td style="text-align: center">16.32%</td> <td style="text-align: center">302</td> <td style="text-align: center">13.39%</td> </tr> <tr> <td style="text-align: center">JAL</td> <td style="text-align: center">389</td> <td style="text-align: center">12.26%</td> <td style="text-align: center">303</td> <td style="text-align: center">13.43%</td> </tr> <tr> <td style="text-align: center">JALR</td> <td style="text-align: center">2</td> <td style="text-align: center">0.06%</td> <td style="text-align: center">1</td> <td style="text-align: center">0.04%</td> </tr> <tr> <td style="text-align: center">LUI</td> <td style="text-align: center">2</td> <td style="text-align: center">0.06%</td> <td style="text-align: center">1</td> <td style="text-align: center">0.04%</td> </tr> <tr> <td style="text-align: center"><strong>TOTAL</strong></td> <td style="text-align: center">3173</td> <td style="text-align: center">100%</td> <td style="text-align: center">2256</td> <td style="text-align: center">100%</td> </tr> </tbody> </table> <div class="caption"> Instruction‑type breakdown for <tt>dual.mergesort</tt> </div> <h1 id="architecture">Architecture</h1> <p>Figure 1 highlights the top-level block diagram of the interfaces we use throughout our design variants. The Caches block is a pass-through for the standalone singlecycle/pipeline, and contains some basic com- binational logic to highlight completion of memory requests. The Datapath block contains the main processor implementation through which the instructions flow.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/437/interfaces-480.webp 480w,/assets/img/437/interfaces-800.webp 800w,/assets/img/437/interfaces-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/437/interfaces.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="interfaces" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Figure 1: Processor Interfaces </div> <p>Figure 2 visualizes the single-cycle processor design.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/437/singlecycle-480.webp 480w,/assets/img/437/singlecycle-800.webp 800w,/assets/img/437/singlecycle-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/437/singlecycle.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="singlecycle" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Figure 2: SingleCycle Processor Block Diagram </div> <p>Figure 3 outlines our pipelined processor design. Here, every memory access in the Memory stage must wait for main-memory latency, leading to pipeline stalls whenever an instruction issues a load or store. Forwarding and Hazard modules (within Datapath) are responsible for ensuring minimal bubble additions while resolving data and control hazards.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/437/pipelined-480.webp 480w,/assets/img/437/pipelined-800.webp 800w,/assets/img/437/pipelined-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/437/pipelined.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="pipelined" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Figure 3: Pipelined Processor Block Diagram </div> <p>In the cached pipeline (Figure 4), we added a split L1 hierarchy: a direct-mapped instruc- tion cache, and a 2-way set-associative data cache. The number of frames and index-splits of the addresses are parameterizable. Each cache uses a write-back, write-allocate policy. On an L1 miss, the data cache controller initiates either LOAD or WRITE-BACK FSM over the simple bus controller and stalls only the Memory stage, allowing earlier stages to continue if they do not depend on the miss. The instruction cache does not allow for writing, but contains an FSM to load the instructions on a miss.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/437/caches.drawio-480.webp 480w,/assets/img/437/caches.drawio-800.webp 800w,/assets/img/437/caches.drawio-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/437/caches.drawio.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="caches" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Figure 4: Caches Block Diagram </div> <p>Our multicore design (Figure 5) instantiates two identical pipelined datapaths, high- lighted as CPU0 and CPU1, each with its own split L1 caches, connected to a shared Bus Control module. We implement the MSI coherence protocol, with no additional SRAM arrays to coordinate the states of each frame. The Bus Controller’s state diagram in Fig- ure 6 arbitrates between competing requests and broadcasts snoop responses. Each core’s data cache includes additional logic to support LR/SC atomic operations, modeled after the RISC-V specification, as shown in Figure 7.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/437/multicore-480.webp 480w,/assets/img/437/multicore-800.webp 800w,/assets/img/437/multicore-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/437/multicore.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="pipelined" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Figure 5: Multicore Block Diagram </div> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/437/bus_control-480.webp 480w,/assets/img/437/bus_control-800.webp 800w,/assets/img/437/bus_control-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/437/bus_control.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="pipelined" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Figure 6: Bus Control Finite-State-Machine </div> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/437/coherence-480.webp 480w,/assets/img/437/coherence-800.webp 800w,/assets/img/437/coherence-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/437/coherence.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="pipelined" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Figure 7: D-Cache Finite-State-Machine </div> <h1 id="results">Results</h1> <p>In this section, we compare the aforementioned designs based on performance metrics such as frequency, cycles per instruction (CPI), instruction latency, total execution time, and FPGA resource utilization. Below, we outline the formulas used to calculate each metric, a short paragraph targeting specific requirements, followed by tables presenting our overall results for all designs.</p> <h2 id="maximum-clock-frequency">Maximum Clock Frequency</h2> <p>The maximum clock frequency is extracted from the <strong>system.log</strong> report.</p> \[f_{\text{max}} = \min\left(\frac{\text{CLK}}{2}, \text{CPUCLK} \right)\] <p>For the pipelined, non-cache processor, \(f_{\text{max}} = 65.23 MHz\)</p> <p>For the pipelined, processor with cache, \(f_{\text{max}} = 55.85 MHz\)</p> <p>For the final multicore processor, \(f_{\text{max}} = 50.04 MHz\)</p> <h2 id="average-cycles-per-instruction-cpi">Average Cycles per Instruction (CPI)</h2> <p>CPI is calculated as:</p> \[\text{CPI} = \frac{\text{Total Clock Cycles}}{\text{Total Instructions Executed}}\] <p>where:</p> <ul> <li>Total Clock Cycles is obtained from the <tt>make system.sim</tt> command.</li> <li>Total Instructions Executed is reported at the end of the simulation (<tt>sim -t</tt> or <tt>sim -t -m</tt>).</li> </ul> <p><strong>NOTE:</strong> The Total Instruction count for <tt>mergesort</tt> is 5409 and <tt>dual.mergesort</tt> and 5429.</p> <h2 id="total-execution-time">Total Execution Time</h2> <p>The total execution time for the program is given by:</p> \[\text{Total Execution Time} = \frac{\text{Total Clock Cycles}}{f_{\text{max}}} s\] <h2 id="instruction-latency">Instruction Latency</h2> <p>Instruction latency represents the time taken for a single instruction to complete.</p> \[\text{Latency}_{\text{single-cycle}} = \frac{\text{Execution Time}}{\text{Total Instructions Executed}} s\] <h2 id="fpga-resource-utilization">FPGA Resource Utilization</h2> <p>The FPGA resource usage includes:</p> <ul> <li>Total Logic Elements – Represents the number of Look-Up Tables (LUTs) used.</li> <li>Total Registers - Represents the number of Flip-Flops (FFs) used.</li> <li>Total Pins – Represents the number of I/O pins used for communication.</li> </ul> <h2 id="summary">Summary</h2> <p>Now, we present tables for a easier comparison of the above metrics.</p> <p><strong>NOTE:</strong> By comparing the differences between the Pipelined processor, with and without a cache, one can view the RAM latency at which caches start helping performance. Even at <tt>RAM Latency = 2</tt>, the caches reduce the execution time of the <tt>mergesort</tt> algorithm. The execution time drops from <strong>269 us</strong> to <strong>194 us</strong>. At higher RAM latencies, the reduction in execution time is even greater.</p> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">LAT</th> <th style="text-align: center">CPI</th> <th style="text-align: center">Total Clock Cycles</th> <th style="text-align: center">Clock Frequency (MHz)</th> <th style="text-align: center">Execution Time (us)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">1.27</td> <td style="text-align: center">6906</td> <td style="text-align: center">34.22</td> <td style="text-align: center">202</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">2.55</td> <td style="text-align: center">13814</td> <td style="text-align: center">34.64</td> <td style="text-align: center">397</td> </tr> <tr> <td style="text-align: center">6</td> <td style="text-align: center">5.10</td> <td style="text-align: center">27628</td> <td style="text-align: center">34.64</td> <td style="text-align: center">798</td> </tr> <tr> <td style="text-align: center">10</td> <td style="text-align: center">7.66</td> <td style="text-align: center">41442</td> <td style="text-align: center">34.64</td> <td style="text-align: center">1196</td> </tr> </tbody> </table> <div class="caption"> Performance Metrics for the Single‑Cycle Processor on <tt>mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">LAT</th> <th style="text-align: center">CPI</th> <th style="text-align: center">Total Clock Cycles</th> <th style="text-align: center">Clock Frequency (MHz)</th> <th style="text-align: center">Execution Time (us)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">1.62</td> <td style="text-align: center">8805</td> <td style="text-align: center">56.93</td> <td style="text-align: center">155</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">3.24</td> <td style="text-align: center">17549</td> <td style="text-align: center">65.23</td> <td style="text-align: center">269</td> </tr> <tr> <td style="text-align: center">6</td> <td style="text-align: center">6.47</td> <td style="text-align: center">35035</td> <td style="text-align: center">65.23</td> <td style="text-align: center">537</td> </tr> <tr> <td style="text-align: center">10</td> <td style="text-align: center">9.71</td> <td style="text-align: center">52521</td> <td style="text-align: center">65.23</td> <td style="text-align: center">805</td> </tr> </tbody> </table> <div class="caption"> Performance Metrics for the Pipelined Processor on <tt>mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">LAT</th> <th style="text-align: center">CPI</th> <th style="text-align: center">Total Clock Cycles</th> <th style="text-align: center">Clock Frequency (MHz)</th> <th style="text-align: center">Execution Time (us)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">1.81</td> <td style="text-align: center">9821</td> <td style="text-align: center">58.39</td> <td style="text-align: center">168</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">2.00</td> <td style="text-align: center">10844</td> <td style="text-align: center">55.85</td> <td style="text-align: center">194</td> </tr> <tr> <td style="text-align: center">6</td> <td style="text-align: center">2.38</td> <td style="text-align: center">12874</td> <td style="text-align: center">55.85</td> <td style="text-align: center">231</td> </tr> <tr> <td style="text-align: center">10</td> <td style="text-align: center">2.75</td> <td style="text-align: center">14902</td> <td style="text-align: center">55.85</td> <td style="text-align: center">267</td> </tr> </tbody> </table> <div class="caption"> Performance Metrics for the Pipelined Processor w/ Caches on <tt>mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">LAT</th> <th style="text-align: center">CPI</th> <th style="text-align: center">Total Clock Cycles</th> <th style="text-align: center">Clock Frequency (MHz)</th> <th style="text-align: center">Execution Time (us)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">2.44</td> <td style="text-align: center">13212</td> <td style="text-align: center">50.04</td> <td style="text-align: center">320</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">2.63</td> <td style="text-align: center">14229</td> <td style="text-align: center">45.12</td> <td style="text-align: center">315</td> </tr> <tr> <td style="text-align: center">6</td> <td style="text-align: center">3.00</td> <td style="text-align: center">16264</td> <td style="text-align: center">45.12</td> <td style="text-align: center">360</td> </tr> <tr> <td style="text-align: center">10</td> <td style="text-align: center">3.38</td> <td style="text-align: center">18300</td> <td style="text-align: center">45.12</td> <td style="text-align: center">406</td> </tr> </tbody> </table> <div class="caption"> Performance Metrics for the Multi‑Core Processor on <tt>mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">LAT</th> <th style="text-align: center">CPI</th> <th style="text-align: center">Total Clock Cycles</th> <th style="text-align: center">Clock Frequency (MHz)</th> <th style="text-align: center">Execution Time (us)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">1.73</td> <td style="text-align: center">9438</td> <td style="text-align: center">50.04</td> <td style="text-align: center">189</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">1.91</td> <td style="text-align: center">10374</td> <td style="text-align: center">45.12</td> <td style="text-align: center">230</td> </tr> <tr> <td style="text-align: center">6</td> <td style="text-align: center">2.26</td> <td style="text-align: center">12299</td> <td style="text-align: center">45.12</td> <td style="text-align: center">273</td> </tr> <tr> <td style="text-align: center">10</td> <td style="text-align: center">2.62</td> <td style="text-align: center">14248</td> <td style="text-align: center">45.12</td> <td style="text-align: center">316</td> </tr> </tbody> </table> <div class="caption"> Performance Metrics for the Multi‑Core Processor on <tt>dual.mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">Design</th> <th style="text-align: center">Latency for LAT=6 (ns)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">Single‑Cycle</td> <td style="text-align: center">148</td> </tr> <tr> <td style="text-align: center">Pipelined</td> <td style="text-align: center">99</td> </tr> <tr> <td style="text-align: center">Pipelined w/ Caches</td> <td style="text-align: center">43</td> </tr> <tr> <td style="text-align: center">Multi‑Core w/ caches</td> <td style="text-align: center">67</td> </tr> </tbody> </table> <div class="caption"> Instruction Latency Comparison </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">Design</th> <th style="text-align: center">Total Logic Elements</th> <th style="text-align: center">Total Registers</th> <th style="text-align: center">Total Pins</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">Single‑Cycle</td> <td style="text-align: center">3505</td> <td style="text-align: center">1835</td> <td style="text-align: center">102</td> </tr> <tr> <td style="text-align: center">Pipelined</td> <td style="text-align: center">3167</td> <td style="text-align: center">1294</td> <td style="text-align: center">106</td> </tr> <tr> <td style="text-align: center">Pipelined w/ Caches</td> <td style="text-align: center">7208</td> <td style="text-align: center">4106</td> <td style="text-align: center">106</td> </tr> <tr> <td style="text-align: center">Multi‑Core w/ caches</td> <td style="text-align: center">14272</td> <td style="text-align: center">7985</td> <td style="text-align: center">106</td> </tr> </tbody> </table> <div class="caption"> FPGA Resource Utilization Comparison </div> <h1 id="conclusion">Conclusion</h1> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Here, we discuss the improvements of each design over the initial Single-Cycle Processor. We evaluate these by calculating the \textbf{Speedup} between the aforementioned values, using this formula:
</code></pre></div></div> \[\text{Speedup %} = \frac{\text{New Value - Old Value}}{\text{Old Value}} * 100%\] <p><strong>NOTE:</strong> When reading the tables, please note the conventions highlighted in the headers.</p> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">LAT</th> <th style="text-align: center">CPUCLK Increase (%)</th> <th style="text-align: center">CPI Increase (%)</th> <th style="text-align: center">Execution Time Decrease (%)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">66.36</td> <td style="text-align: center">27.56</td> <td style="text-align: center">23.27</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">88.30</td> <td style="text-align: center">27.06</td> <td style="text-align: center">32.24</td> </tr> <tr> <td style="text-align: center">6</td> <td style="text-align: center">88.30</td> <td style="text-align: center">26.86</td> <td style="text-align: center">32.71</td> </tr> <tr> <td style="text-align: center">10</td> <td style="text-align: center">88.30</td> <td style="text-align: center">26.76</td> <td style="text-align: center">32.69</td> </tr> </tbody> </table> <div class="caption"> Pipelined (over Single‑Cycle) Processor Speedup on <tt>mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">LAT</th> <th style="text-align: center">CPUCLK Increase (%)</th> <th style="text-align: center">CPI Increase (%)</th> <th style="text-align: center">Execution Time Decrease (%)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">46.23</td> <td style="text-align: center">27.56</td> <td style="text-align: center">–58.41</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">46.23</td> <td style="text-align: center">3.13</td> <td style="text-align: center">15.62</td> </tr> <tr> <td style="text-align: center">6</td> <td style="text-align: center">46.23</td> <td style="text-align: center">41.17</td> <td style="text-align: center">52.01</td> </tr> <tr> <td style="text-align: center">10</td> <td style="text-align: center">46.23</td> <td style="text-align: center">–55.87</td> <td style="text-align: center">63.96</td> </tr> </tbody> </table> <div class="caption"> Multi‑Core (over Single‑Cycle) Processor Speedup on <tt>mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">LAT</th> <th style="text-align: center">CPUCLK Increase (%)</th> <th style="text-align: center">CPI Increase (%)</th> <th style="text-align: center">Execution Time Decrease (%)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">46.23</td> <td style="text-align: center">36.22</td> <td style="text-align: center">6.435</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">44.45</td> <td style="text-align: center">−25.09</td> <td style="text-align: center">47.85</td> </tr> <tr> <td style="text-align: center">6</td> <td style="text-align: center">44.45</td> <td style="text-align: center">−55.68</td> <td style="text-align: center">69.17</td> </tr> <tr> <td style="text-align: center">10</td> <td style="text-align: center">44.45</td> <td style="text-align: center">−65.79</td> <td style="text-align: center">76.17</td> </tr> </tbody> </table> <div class="caption"> Multi‑Core (over Single‑Cycle) Processor Speedup on <tt>dual.mergesort</tt> </div> <table class="table table-bordered table-sm"> <thead> <tr> <th style="text-align: center">Design</th> <th style="text-align: center">LE Increase (%)</th> <th style="text-align: center">Reg Increase (%)</th> <th style="text-align: center">Pin Increase (%)</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">Pipelined</td> <td style="text-align: center">−9.64</td> <td style="text-align: center">−29.49</td> <td style="text-align: center">3.92</td> </tr> <tr> <td style="text-align: center">Pipelined w/ Caches</td> <td style="text-align: center">105.69</td> <td style="text-align: center">123.82</td> <td style="text-align: center">3.92</td> </tr> <tr> <td style="text-align: center">Multi‑Core w/ caches</td> <td style="text-align: center">307.27</td> <td style="text-align: center">335.37</td> <td style="text-align: center">3.92</td> </tr> </tbody> </table> <div class="caption"> Percentage Increase in FPGA Resource Usage (over Single‑Cycle) </div> <p>Across all latencies, our 5‑stage pipeline raises the maximum clock frequency by (maximum) 88%, at the cost of a 27% CPI increase from pipeline hazards and stalls. This trade‑off yields a (maximum) 33% decrease in total execution time. By splitting instruction execution into shorter stages, the pipeline shortens the critical path, hence the higher clock rate.</p> <p>Instantiating two cores and running the original <tt>mergesort</tt> as a single-threaded benchmark improves clock rate by around 44%. However, the CPI speedups are uneven: at LAT=0 the CPI increases by 27%, with 58% slower execution time, whereas at higher latencies we gain a 50+% time speedup. The initial slowdown at LAT=0 is because of MSI-coherence overhead and lower maximum frequency. As RAM latency increases, memory stalls become longer, and the Multi-Core design’s ability to overlap requests begins to help.</p> <p>Running <tt>mergesort</tt> in parallel reduces CPI by up to 66% at high latencies. Execution time falls by 6% even at LAT=0, and by up to 76% at LAT=10. This speedup reflects effective parallelism of the workload – with both cores kept busy and local caches absorbing much of the memory latency.</p> <p>Finally, our FPGA resource utilization figure highlights that we mildly save on some hardware when moving from Single-Cycle to the Pipelined design. This can attributed to the use of latching, simplifying long combinational chains. However, with the addition of caches, we see almost a 105% increase over the single-cycle design, due to the large SRAM-array control logic that needs to be embedded. In our Multi-Core design, we more than double our hardware resources from the Pipelined design, owing to the larger Bus Controller, and a duplication of the complete datapath.</p> <p>Overall, these results confirm that \begin{itemize} \item pipelining is a fundamental throughput optimization; it trades a small CPI penalty for a relatively greater clock-rate speedup. \item parallel hardware with coherence can show greater speedup, particularly amortizing the effective memory access stalls; it trades greater FPGA resource utilization for overall program efficiency. \end{itemize}</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Akshath Raghav Ravikiran. Last updated: May 15, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>